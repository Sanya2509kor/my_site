{% extends "base.html" %}
{% load static %}

{% block modal_cart %}
{% include "includes/cart_button.html" %}
{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'deps/css/auth.css' %}">
{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <h2 class="auth-title">
                <i class="bi bi-door-open"></i> Авторизация
            </h2>
            <div class="auth-logo">
                <span style="font-family: 'Playfair Display', serif; color: #d4af37;">СеАл</span>
            </div>
        </div>

        <form action="{% url 'user:login' %}" method="post" class="auth-form">
            {% csrf_token %}
            
            {% if request.GET.next %}
                <input type="hidden" name="next" value="{{ request.GET.next }}">
            {% endif %}

            <div class="form-group">
                <label for="id_username" class="form-label">
                    <i class="bi bi-person"></i> Имя пользователя
                </label>
                <input type="text" class="form-control" id="id_username" 
                    value="{% if form.username.value %}{{ form.username.value }}{% endif %}"  
                    name="username" placeholder="Введите ваш логин" required>
                <div class="form-icon">
                    <i class="bi bi-check-circle"></i>
                </div>
            </div>

            <div class="form-group">
                <label for="id_password" class="form-label">
                    <i class="bi bi-lock"></i> Пароль
                </label>
                <input type="password" class="form-control" 
                    name="password" id="id_password" 
                    placeholder="Введите ваш пароль" required>
                <div class="form-icon">
                    <i class="bi bi-eye-slash toggle-password"></i>
                </div>
            </div>

            <div class="form-options">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="rememberMe">
                    <label class="form-check-label" for="rememberMe">Запомнить меня</label>
                </div>
                <a href="{% url 'user:password_reset' %}" class="forgot-password">Забыли пароль?</a>
            </div>

            <button type="submit" class="btn-auth">
                <i class="bi bi-box-arrow-in-right"></i> Войти
            </button>
        </form>

        <div class="auth-footer">
            <p>Ещё нет аккаунта? <a href="{% url 'user:registration' %}" class="auth-link">Зарегистрируйтесь</a></p>
            
            {% comment %}
            <div class="social-auth">
                <p class="divider">Или войдите через</p>
                <div class="social-buttons">
                    <a href="#" class="btn-social google">
                        <i class="bi bi-google"></i>
                    </a>
                    <a href="#" class="btn-social facebook">
                        <i class="bi bi-facebook"></i>
                    </a>
                    <a href="#" class="btn-social github">
                        <i class="bi bi-github"></i>
                    </a>
                </div>
            </div>
            {% endcomment %}
        </div>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Показать/скрыть пароль
    const togglePassword = document.querySelector('.toggle-password');
    const passwordInput = document.getElementById('id_password');
    
    if (togglePassword && passwordInput) {
        togglePassword.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            this.classList.toggle('bi-eye');
            this.classList.toggle('bi-eye-slash');
        });
    }
    
    // Валидация формы
    const form = document.querySelector('.auth-form');
    if (form) {
        form.addEventListener('submit', function(e) {
            const username = document.getElementById('id_username');
            const password = document.getElementById('id_password');
            
            if (!username.value.trim()) {
                e.preventDefault();
                username.focus();
            }
            
            if (!password.value.trim()) {
                e.preventDefault();
                password.focus();
            }
        });
    }
});
</script>
{% endblock %}